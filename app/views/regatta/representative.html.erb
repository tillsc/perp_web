<%= render 'header' %>

<p>Hallo <%= @representative.first_name %> <%= @representative.last_name %></p>

<h3>Meine Teams</h3>

<% @teams.flat_map{ |t| t.participants.flat_map(&:event) }.uniq.each do |event| %>
  <%= link_to event.label, event_participants_path(@regatta, event) %>
  [<%= link_to "Starts", event_starts_path(@regatta, event) %>,
  <%= link_to "Ergebnisse", event_results_path(@regatta, event) %>]
  <ul>
    <% @teams.flat_map(&:participants).
       select { |p| p.event == event }.
       sort_by{ |p| p.number.to_i }.
      each do |participant| %>
      <li>
        <%= participant.number %>:
        <%= participant.team_name %><br>
        <em><%= participant.rower_names %></em>
      </li>
    <% end %>
  </ul>
<% end %>